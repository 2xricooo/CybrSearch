<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CybrSearch ‚Äî Free Breach Scanner</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body {
      margin: 0; padding: 60px 0;
      background: linear-gradient(to bottom right,#0f0f0f,#1a1a1a);
      color: #e0e0e0; font-family: 'Segoe UI', sans-serif;
    }
    .container { max-width: 700px; }
    .card {
      background: rgba(20,20,20,0.95); border:1px solid #2c2c2c;
      backdrop-filter: blur(12px); box-shadow:0 10px 35px rgba(0,0,0,0.6);
      border-radius:1rem; padding:2rem;
    }
    .form-control {
      background:#121212; color:#fff; border:1px solid #333;
      border-radius:0.7rem; padding:14px; margin-bottom:1rem;
      transition: border 0.3s, box-shadow 0.3s;
    }
    .form-control:focus {
      outline:none; border-color:#2dd4bf;
      box-shadow:0 0 0 2px #2dd4bf55; background:#181818;
    }
    .btn-primary {
      background: linear-gradient(to right,#2dd4bf,#0ea5e9);
      border:none; font-weight:bold; font-size:17px;
      border-radius:0.6rem; padding:10px; width:100%;
      transition: background 0.3s;
    }
    .btn-primary:hover {
      background: linear-gradient(to right,#0ea5e9,#2dd4bf);
    }
    .result-box {
      background:#181818; border-left:5px solid #444;
      padding:1rem; border-radius:0.6rem; margin-top:0.8rem;
      font-family: monospace; white-space: pre-wrap;
    }
    .result-box.success {border-color:#22c55e; color:#bbf7d0;}
    .result-box.warning {border-color:#eab308; color:#fef9c3;}
    .result-box.error {border-color:#ef4444; color:#fecaca;}
  </style>
</head>
<body>

<div class="container text-center">
  <div class="card">
    <h1>üß† CybrSearch (Free Scanner)</h1>
    <form onsubmit="return searchData();">
      <input id="email" type="email" class="form-control" placeholder="üìß Email">
      <input id="password" type="password" class="form-control" placeholder="üîí Check Password (optional)">
      <input id="ip" type="text" class="form-control" placeholder="üåê IP address (optional)">
      <button type="submit" class="btn btn-primary">üöÄ Scan</button>
    </form>
  </div>
  <div id="results" class="mt-4 text-start"></div>
</div>

<script type="module">
  function updateResult(msg, type = 'success') {
    const box = document.createElement('div');
    box.className = `result-box ${type}`;
    box.innerText = msg;
    document.getElementById('results').appendChild(box);
  }

  async function sha1(str) {
    const buffer = await crypto.subtle.digest("SHA-1", new TextEncoder().encode(str));
    return Array.from(new Uint8Array(buffer)).map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();
  }

  async function checkPassword(password) {
    const hash = await sha1(password);
    const prefix = hash.slice(0, 5);
    try {
      const res = await fetch(`https://api.pwnedpasswords.com/range/${prefix}`);
      const text = await res.text();
      const lines = text.split('\n');
      const match = lines.find(line => line.split(':')[0] === hash.slice(5));
      if (match) {
        const count = match.split(':')[1];
        updateResult(`‚ö†Ô∏è Password has appeared in ${count} breaches.`, 'warning');
      } else {
        updateResult('‚úÖ Password NOT found in known breaches.', 'success');
      }
    } catch (e) {
      updateResult(`‚ùå Error checking password: ${e.message}`, 'error');
    }
  }

  async function checkIP(ip) {
    try {
      const res = await fetch(`https://ipwho.is/${ip}`);
      const data = await res.json();
      if (!data.success) {
        updateResult(`‚ö†Ô∏è IP Geo lookup failed: ${data.message || "Unknown error"}`, 'warning');
        return;
      }

      updateResult(`üåê IP Info:
- IP: ${data.ip}
- Country: ${data.country}
- Region: ${data.region}
- City: ${data.city}
- ISP: ${data.connection?.isp || 'N/A'}
- Org: ${data.connection?.org || 'N/A'}
- ASN: ${data.connection?.asn || 'N/A'}`, 'success');
    } catch (e) {
      updateResult(`‚ùå Error fetching IP info: ${e.message}`, 'error');
    }

    try {
      const res = await fetch(`https://rdap.arin.net/registry/ip/${ip}`);
      const rdap = await res.json();

      const org = rdap.entities?.[0]?.vcardArray?.[1]?.find(v => v[0] === 'fn')?.[3] || 'N/A';
      const name = rdap.name || 'N/A';
      const range = `${rdap.startAddress || 'N/A'} - ${rdap.endAddress || 'N/A'}`;

      updateResult(`üìÑ RDAP Info:
- Name: ${name}
- Org: ${org}
- Range: ${range}
- More: https://search.arin.net/rdap/?query=${ip}`, 'success');
    } catch (e) {
      updateResult(`‚ùå Error fetching RDAP info: ${e.message}`, 'error');
    }
  }

  async function searchData() {
    document.getElementById('results').innerHTML = '';

    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    const ip = document.getElementById('ip').value.trim();

    if (!email && !password && !ip) {
      alert('‚ùó Enter at least one field to search.');
      return false;
    }

    if (email) {
      updateResult(`‚ÑπÔ∏è Email breach check is simulated. Actual API requires a key.
Use https://haveibeenpwned.com/ to check manually.`, 'warning');
    }

    if (password) await checkPassword(password);
    if (ip) await checkIP(ip);

    return false;
  }
</script>

</body>
</html>
